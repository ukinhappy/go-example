package main

import (
	"fmt"
	"github.com/gomodule/redigo/redis"
	"strings"
	"time"
)

// dial dials connections then returns pool.
func dial(addr, pw string) *redis.Pool {
	dialOptions := []redis.DialOption{
		redis.DialConnectTimeout(time.Second),
		redis.DialReadTimeout(time.Second),
		redis.DialWriteTimeout(time.Second),
	}
	if pw != "" {
		dialOptions = append(dialOptions, redis.DialPassword(pw))
	}
	return &redis.Pool{
		Dial: func() (redis.Conn, error) {
			c, err := redis.Dial("tcp", addr, dialOptions...)
			if err != nil {
				return nil, err
			}

			return c, nil
		},
		MaxIdle:     1000,
		MaxActive:   1000,
		IdleTimeout: time.Second * 100,
	}
}

func main() {
	//lua()
	//snowflake()
	//incrlua()
	t()
}

func t() {

	var str = `20104032,20104025,20104023,20104035,20104024,20104036,20104027,20104026,20104038,20104028,20104029,20104031,20104030,20104039,20099482,20104034,20104037,20104033,20104040,20104044,20104045,20104047,20104046,20104049,20104048,20104050,20104051,20104043,20104042,20104055,20104059,20104054,20104058,20104053,20104057,20104060,20104052,20104056,20104068,20104069,20104070,20104071,20104072,20104065,20104066,20104067,20104062,20104063,20104064,20104075,20104079,20104074,20104078,20104077,20104073,20104076,20104080,20104082,20104085,20104087,20104084,20104086,20104088,20104089,20104090,20104091,20104099,20104095,20104098,20104094,20104097,20104093,20104100,20104096,20104092,20104106,20104109,20104105,20104107,20104104,20104108,20104110,20104102,20104103,20104115,20104119,20104111,20104114,20104118,20104113,20104117,20104120,20104116,20104112,20104128,20104129,20104130,20104122,20104124,20104123,20104125,20104127,20104126,20104138,20104139,20104135,20104131,20104134,20104137,20104133,20104136,20104132,20104140,20104152,20104143,20104142,20104144,20104147,20104148,20104145,20104146,20104149,20104150,20104151,20104159,20104155,20104158,20104154,20104157,20104153,20104160,20104156,20104166,20104165,20104167,20104164,20104168,20104169,20104170,20104162,20104163,20104175,20104171,20104179,20104174,20104178,20104173,20104177,20104172,20104180,20104176,20104189,20104190,20104188,20104184,20104183,20104182,20104185,20104187,20104186,20104199,20104195,20104191,20104198,20104194,20104197,20104193,20104196,20104200,20104192,20104202,20104204,20104203,20104205,20104206,20104207,20104209,20104208,20104210,20104211,20104219,20104215,20104218,20104214,20104217,20104213,20104220,20104216,20104212,20104224,20104227,20104225,20104228,20104229,20104226,20104230,20104222,20104223,20104235,20104231,20104239,20104234,20104238,20104233,20104237,20104232,20104240,20104236,20104249,20104250,20104248,20104243,20104244,20104242,20104245,20104246,20104247,20104259,20104255,20104251,20104258,20104254,20104257,20104253,20104256,20104252,20104260,20104262,20104263,20104269,20104265,20104264,20104270,20104267,20104266,20104268,20104279,20104271,20104275,20104278,20104274,20104277,20104273,20104280,20104276,20104272,20104285,20104286,20104287,20104284,20104288,20104289,20104290,20104282,20104283,20104295,20104291,20104299,20104294,20104298,20104293,20104297,20104292,20104300,20104296,20104308,20104309,20104310,20104302,20104304,20104303,20104305,20104306,20104307,20104319,20104315,20104311,20104318,20104314,20104317,20104313,20104316,20104312,20104320,20104322,20104324,20104325,20104326,20104323,20104328,20104329,20104327,20104330,20104331,20104339,20104335,20104338,20104334,20104337,20104333,20104340,20104336,20104332,20104344,20104349,20104348,20104345,20104347,20104350,20104346,20104343,20104342,20104355,20104359,20104351,20104354,20104358,20104353,20104357,20104360,20104356,20104352,20104369,20104368,20104370,20104363,20104364,20104362,20104365,20104377,20104366,20104367,20104379,20104375,20104371,20104378,20104374,20104373,20104376,20104372,20104380,20104382,20104384,20104387,20104383,20104386,20104385,20104389,20104388,20104400,20104390,20104391,20104395,20104399,20104398,20104394,20104397,20104393,20104396,20104392,20104404,20104405,20104406,20104408,20104407,20104409,20104410,20104402,20104403,20104415,20104411,20104419,20104414,20104418,20104413,20104417,20104412,20104420,20104416,20106371,20106373,20106374,20106377,20106375,20106376,20106378,20106380,20106379,20106381,20106383,20106391,20106387,20106382,20106390,20106386,20106389,20106385,20106388,20106384,20106397,20106396,20106398,20106399,20106400,20106393,20106401,20106394,20106395,20106407,20106411,20106403,20106406,20106402,20106410,20106405,20106409,20106404,20106408,20106420,20106421,20106413,20106416,20106415,20106414,20106417,20106418,20106419,20106431,20106427,20106423,20106430,20106426,20106422,20106429,20106425,20106428,20106424,20106433,20106434,20106436,20106435,20106437,20106438,20106440,20106439,20106441,20106443,20106451,20106447,20106442,20106450,20106446,20106449,20106445,20106448,20106444,20106461,20106458,20106457,20106459,20106456,20106472,20106460,20106462,20106454,20106455,20106467,20106471,20106463,20106466,20106470,20106465,20106469,20106468,20106464,20104083,46503133,45298284,20121903,20051046,20121703,20051047,20051045,45898993,45298291,45898994,45898946,45898945,45898944,45898948,45298274,45898956,45298248,45898949,45898952,45898950,45898951,45898953,45898954,45898963,45898959,45898962,45898958,45898957,45898961,45898964,45898960,20191117,20191120,20191119,20191122,20191123,20191118,20191121,20191112,20191124,20191126,20191114,20189699,20191127,20191115,20191113,20191125,20191128,20189700,20191116,20191140,20191130,20191132,20191144,20191135,20191134,20191146,20191133,20191145,20191131,20191136,20191148,20191137,20191138,20191139,20191143,20191147,20191142,20191141,20191153,20191152,20191164,20191157,20191154,20191155,20191156,20191159,20191158,20191160,20191151,20191150,20191163,20191167,20191162,20191166,20191161,20191165,20191168,20191177,20191176,20191180,20191178,20191171,20191170,20191173,20191172,20191184,20191174,20191175,20191187,20191183,20191179,20191186,20191182,20191185,20191181,20191188,20191200,20191191,20191195,20191192,20191204,20191190,20191193,20191194,20191196,20191208,20191198,20191197,20191199,20191207,20191203,20191206,20191202,20191205,20191201,20296392,20296380,20296382,20296381,20296393,20296383,20296384,20296385,20296386,20296387,20296388,20296389,20191209,20296378,20296390,20296379,20296391,20296377,20296376,20296396,20296403,20296411,20296399,20296407,20296402,20296398,20296410,20296406,20296401,20296413,20296409,20296397,20296405,20296408,20296395,20296412,20296400,20296404,20296427,20296423,20296419,20296426,20296422,20296418,20296733,20296421,20296425,20296416,20296735,20296429,20296736,20296417,20296424,20296420,20296415,20296734,20296428,20296739,20296751,20296747,20296743,20296750,20296755,20296738,20296746,20296754,20296742,20296749,20296753,20296741,20296745,20296756,20296744,20296748,20296752,20296740,20296763,20296775,20296771,20296767,20296762,20296774,20296770,20296758,20296766,20296773,20296761,20296769,20296765,20296760,20296772,20296768,20296759,20296776,20296764,20041452,20041457,20041441,20041448,20041454,20041442,20041447,20041459,20041451,20041455,20041450,20041449,20041453,20041445,20041444,20041456,20041766,20041776,20041765,20041771,20041759,20041760,20041762,20041761,20041775,20041763,20041767,20041770,20041758,20041773,20041769,20041764,20041446,44898020,44497270,44497271,44497311,44898106,44898104,64612300,64612236,64612439,64612422,64612315,64612562,64612423,64613056,64612412,64612313,64612387,64612318,64612414,64612408,64612553,64612417,64612380,64612332,64612326,64612319,64612255,64612304,64613092,64613048,64612413,64612324,64612264,64612308,64613061,64612390,64612523,64612521,64612381,64612569,64612297,64612499,64612407,64612497,64612259,64612424,64612400,64612551,64612436,64612564,64613095,64612231,64612235,64612339,64612335,64612330,64612565,64612547,64612473,64612237,64612253,64612250,64612238,64612402,64612295,64612401,64612289,64613136,64612261,64612534,64612252,64612535,64613121,64612239,64612406,64612566,64612546,64612340,64612403,64612549,64612327,64612427,64612495,64612548,64613051,64612256,64612314,64612539,64612418,64613049,64612415,64612532,64612533,64612945,64612347,64612655,64612743,64612343,64612707,64613128,64613130,64612697,64612293,64612331,64612695,64612431,64612496,64612291,64612656,64612260,64612404,64612430,64612317,64612440,64613050,64612437,64612241,64612309,64612303,64612301,64612305,64612434,64612240,64612292,64612536,64612405,64612552,64612392,64612254,64612391,64612396,64613138,64612524,64612420,64612248,64612385,64612409,64612371,64612336,64612416,64612294,64612334,64613137,64612429,64612267,64612266,64612296,64612323,64612321,64612425,64612395,64612441,64612426,64612421,64612310,64612393,64612394,64613129,64612388,64612397,64612312,64612522,64612379,64612520,64612351,64612389,64612383,64612344,64612341,64612346,64612345,64612265,64612337,64612232,64612501,64612433,64612384,64612333,64612502,64612432,64612329,64612290,64612288,64612328,64612382,64612500,64612262,64612263,64612320,64612325,64612322,64612428,64612513,64612258,64612316,64612257,64612350,64612311,64612419,64613127,64612505,64612438,64612338,64612504,64612435,64612249,64612503,64612302,64612251,64612342,64612233,64611126,64611852,64611756,64611853,64611760,64611815,64611855,64611854,64611106,64611856,64611759,64611857,64611108,64611858,64611110,64611761,64611762,64611859,64611114,64611860,64611763,64611863,64611862,64611116,64611861,64611118,64611864,64611865,64611767,64611764,64611867,64611868,64611765,64611869,64611872,64611766,64611871,64611124,64611873,64611768,64611813,64611875,64611878,64611876,64611812,64611891,64611882,64611880,64611816,64611839,64611133,64611892,64611817,64611135,64611944,64611136,64611943,64611945,64611823,64611946,64611141,64611818,64611948,64611143,64611819,64611949,64611822,64611145,64611144,64611952,64611951,64611950,64611953,64611835,64611954,64611838,64611475,64611956,64611479,64611482,64611957,64611958,64611960,64611959,64611961,64611836,64611837,64611491,64611962,64611987,64611986,64611495,64611499,64611498,64611991,64611990,64611989,64611507,64611841,64611992,64611993,64611842,64611995,64611994,64611511,64611515,64611514,64611996,64611997,64611850,64611999,64611998,64612000,64612001,64612003,64612002,64611524,64611757,64612004,64611528,64612027,64612006,64612005,64611532,64611531,64611545,64612038,64612040,64612039,64611540,64612041,64612042,64612054,64611546,64612055,64612056,64611866,64612060,64612059,64612057,64611556,64611560,64612061,64612062,64612076,64611564,64611563,64611881,64612203,64612204,64611572,64612230,64612228,64612227,64612226,64611723,64612205,64611105,64611724,64611121,64611113,64611109,64611107,64611111,64611112,64611117,64611115,64611120,64611119,64611129,64611125,64611123,64611122,64611127,64611128,64611130,64611131,64611132,64611134,64611137,64611138,64611139,64611140,64611142,64611146,64611147,64611148,64611476,64611477,64611478,64611481,64611480,64611484,64611483,64611485,64611486,64611488,64611487,64611489,64611490,64611492,64611493,64611494,64611496,64611848,64611497,64611500,64611501,64611502,64611504,64611503,64611505,64611506,64611508,64611509,64611510,64611513,64611517,64611516,64611518,64611519,64611521,64611520,64611522,64611523,64611525,64611526,64611527,64611529,64611530,64611533,64611534,64611535,64611537,64611536,64611538,64611539,64611541,64611542,64611543,64611544,64611549,64611548,64611547,64611550,64611551,64611553,64611552,64611554,64611555,64611557,64611558,64611559,64611561,64611562,64611565,64611566,64611567,64611569,64611568,64611570,64611571,64611573,64611718,64611735,64611736,64611740,64611748,64611947,64611955,64611988,64611844,64611821,64611820,64611840,64611843,64611851,64611849,64610861,64610842,64610848,64610846,64610844,64610843,64610756,64610759,64610845,64610778,64610847,64610782,64610860,64610854,64610851,64610850,64610849,64610790,64610801,64610853,64610852,64610859,64610857,64610855,64610856,64610811,64610858,64611104,64611091,64610875,64610867,64610863,64610862,64610820,64610824,64610865,64610864,64610866,64610871,64610869,64610868,64610870,64610874,64610873,64610872,64611090,64610883,64610879,64610877,64610876,64610878,64610881,64610880,64610882,64610931,64610922,64610892,64610884,64610924,64611089,64611057,64611103,64611098,64611095,64611093,64611092,64611094,64611097,64611096,64611102,64611101,64611100,64611099,64610827,64610826,64610054,64610050,64610045,64610049,64610046,64610048,64610047,64610731,64610055,64610781,64610755,64610734,64610733,64610732,64610738,64610736,64610737,64610750,64610780,64610757,64610761,64610760,64610779,64610783,64610794,64610810,64610815,64610814,64610823,64610825,64610735,64610841,64610840,64610839,64610838,64610837,64610836,64610835,64610834,64610833,64610832,64610831,64610830,64610829,64610828,64610043,64610044,64610041,64610039,64610040,64610042,64610030,64610025,64610021,64610017,64610018,64610019,64609739,64610016,64609733,64609724,64609725,64609723,64609722,64609721,64609720,64609726,64610020,64609719,64609646,64609644,64609645,64609647,63809558,63809559,63809567,63809576,63809554,63809553,64613139`
	p := dial("172.16.1.202:6000", "123456.com").Get()

	p.Do("lpush", "potential_member20201216", fmt.Sprintf("%s,%d,%d", "45298333", 1, 1607930607))
	return

	uidm := make(map[string]bool)
	uids, _ := redis.Strings(p.Do("lrange", "potential_member20201215", 0, -1))
	for _, uid := range uids {
		uidm[strings.Split(uid,",")[0]] = true
	}
	fmt.Println(len(uidm))
	return
	uids = strings.Split(str, ",")
	for i := 0; i < 510; i++ {
		p.Do("lpush", "potential_member20201215", fmt.Sprintf("%s,%d,%d", uids[i], 1, 1607930607))
	}

}
